C51 COMPILER V9.00   452                                                                   04/15/2016 14:03:32 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE 452
OBJECT MODULE PLACED IN 452.OBJ
COMPILER INVOKED BY: E:\安装程序\kill\C51\BIN\C51.EXE 452.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          
   2          
   3          #include <stc12c5a.h>//包含头文件
   4          #include"y452.h"
   5          
   6          unsigned char code th[] = {//定时器0高八位频率设定
   7          0x27,0xE2,0xE4,0xE6,0xE7,0xE8,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,0xF0,0xF1,
   8          //低八度0,b1,1,#1,2,#2,3,4,#4,5,#5,6,#6,7
   9          0xF2,0xF3,0xF3,0xF4,0xF5,0xF5,0xF6,0xF6,0xF7,0xF7,0xF8,0xF8,
  10          //中音1,#1,2,#2,3,4,#4,5,#5,6,#6,7
  11          0xF9,0xF9,0xF9,0xFA,0xFA,0xFA,0xFB,0xFB,0xFB,0xFB,0xFC,0xFC,0xFC
  12          //高八度1,#1,2,#2,3,4,#4,5,#5,6,#6,7,#7
  13          };
  14          unsigned char code tl[] = {//定时器0低八位频率设定
  15          0xFF,0xD9,0x84,0x19,0x82,0xEB,0x2E,0x5E,0x97,0xA1,0xB0,0xA2,0x94,0x6C,
  16          //低八度0,b1,1,#1,2,#2,3,4,#4,5,#5,6,#6,7
  17          0x3B,0x06,0xBB,0x70,0x12,0xAE,0x48,0xD0,0x58,0xD0,0x4A,0xB5,
  18          //中音1,#1,2,#2,3,4,#4,5,#5,6,#6,7
  19          0x1F,0x84,0xDE,0x39,0x8A,0xD8,0x24,0x67,0xAB,0xE8,0x22,0x56,0x8C
  20          //高八度1,#1,2,#2,3,4,#4,5,#5,6,#6,7,#7
  21          };
  22          unsigned char code ysjs[] = {//延时计算一个单位时间为0.021s
  23          1,6,7,7,7,8,8,9,9,10,10,11,12,12,
  24          //低八度0,b1,1,#1,2,#2,3,4,#4,5,#5,6,#6,7
  25          13,14,15,16,17,18,19,20,21,22,24,25,
  26          //中音1,#1,2,#2,3,4,#4,5,#5,6,#6,7
  27          26,28,30,31,33,35,37,40,42,44,47,50,53
  28          //高八度1,#1,2,#2,3,4,#4,5,#5,6,#6,7,#7
  29          };
  30          unsigned char code jpsz[] = {2,4,5,7,11,13,15,24,28,32,49,66};//对应节拍数组
  31          
  32          unsigned char code yb1[][2] = {//歌曲音符节拍调用数组
  33          {9,3},{16,3},{18,3},{0,3},{0,6},{0,6},{18,3},{9,3},{6,6},{14,6},{16,3},{18,3},{21,3},{23,4},{21,1},{21,3},
             -{16,6},{9,3},{16,3},{18,3},{18,3},{6,3},{11,3},{14,3},{16,3},{18,3},{26,3},{25,6},{26,3},{25,6},{21,3},{21,1},{14,1},{23
             -,1},{21,1},{23,3},{11,3},{14,3},{11,3},{19,3},{18,3},{19,3},{26,3}
  34          };
  35          
  36          void ds1()
  37          {
  38   1          TMOD |= 0x11;//打开定时器0，工作模式为1
  39   1          TR0=1;//定时器0开关打开
  40   1          EA=1;//总中断打开
  41   1          ET0=1;//定时器0中断打开
  42   1      }
  43          
  44          void ds0_d0()interrupt 1//当定时器0溢出中断
  45          {
  46   1          TH0 = th[yb1[bf][0]];//定时器0高8位给定时值
  47   1          TL0 = tl[yb1[bf][0]];//定时器0低8位给定时值
  48   1          if (th[yb1[bf][0]] != 0x27 && tl[yb1[bf][0]] != 0xFF)
  49   1      {//当没有播放到休止符0
  50   2          fmq = ~fmq;//蜂鸣器振动发声
  51   2      }
  52   1          jp0++;//计数器加一计数
  53   1      if (jp0 == ysjs[yb1[bf][0]])
C51 COMPILER V9.00   452                                                                   04/15/2016 14:03:32 PAGE 2   

  54   1      {//如果当前音符播放了0.03s
  55   2          jp1++;//节拍,播放个数加1
  56   2          jp0 = 0;//计数器归零
  57   2      }
  58   1      if (jp1 == jpsz[yb1[bf][1]])
  59   1      {//如果当前音符播放完成一个指定的节拍
  60   2          bf++;//播放位置跳到下一个音符节拍
  61   2          jp1 = 0;//计数器归零
  62   2      if(bf == 43)
  63   2      {//如果播放到最后一位，即播放完成
  64   3          bf = 0;//从头播放
  65   3        }
  66   2        }
  67   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    144    ----
   CONSTANT SIZE    =    215    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
